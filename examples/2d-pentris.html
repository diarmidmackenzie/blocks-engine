<html>
  <head>
    <script src="https://aframe.io/releases/1.1.0/aframe.min.js"></script>
    <script src="https://unpkg.com/aframe-environment-component@2.0.0/dist/aframe-environment-component.min.js"></script>
    <script src="https://unpkg.com/aframe-extras@6.1.0/dist/aframe-extras.min.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/diarmidmackenzie/key-bindings@v0.1-alpha/key-bindings.min.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/diarmidmackenzie/6dof-object-control@v0.1-alpha/src/6dof-object-control.min.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/diarmidmackenzie/6dof-object-control@v0.1-alpha/src/keyboard-hand-controls.min.js"></script>
    <script src="../src/tetris.js"></script>
  </head>
  <body>
    <a-scene>
      <a-entity id="rig" movement-controls>
        <a-entity camera position="0 1.6 0" look-controls accesskey="">
        </a-entity>
      </a-entity>
      <a-entity id="rhand"
                hand-controls="hand: right"
                keyboard-hand-controls="logger:#log-panel3"
                position="0.2 1.3 -0.3">
      </a-entity>
      <a-entity id="lhand"
                hand-controls="hand: left">
      </a-entity>


      <a-mixin id="cube" geometry="primitive: box;"
               scale="0.1 0.1 0.1"
               shadow></a-mixin>

      <a-entity environment="preset: forest; dressingAmount: 500"></a-entity>
      <a-entity light="type:directional; castShadow:true;" position='0 20 0'></a-entity>

      <!-- Shape generator must be on a grid position that aligns with the shape
       constraints, as the 6dof positions provided are absolute, not relative, and
       so will always be in line with the global grid.  Position arena
       appropriately to handle this -->

     <a-entity id='shape-gen' shapegenerator="shapes:EEEE,EEEU,EEED,EEUE,EEDE,EEDD,EEDW,EEUW,EEWDD,EDED,EDEWD,WDWED,EUDDUE;
                                             keys:KeyZ=xminus,
                                                  KeyX=xplus,
                                                  Enter=zRotMinus,
                                                  ShiftRight=zRotPlus,
                                                  Space=drop;
                                                  debug:true;
                                                  logger1:#log-panel1;
                                                  logger2:#log-panel2"
                                             position = "0 2.0 -1.0"></a-entity>

      <a-entity tetrisgame="generator: #shape-gen; scoreboard: #scoreboard"></a-entity>
      <!-- Putting the arena exactly below the dropper when the arena has
       an even number of spaces creates ambuiguous intent.
      So we are careful to set this a half-block to the left of the dropper.
      This is exclusively done for even-width arenas. -->

      <a-plane show-data shadow="receive:true" height="0.1" width="1.2" rotation="-90 0 0" id="arena" arena="x: 12; z: 1" position = "0.05 0.5 -1.0" ></a-plane>
      <a-text id="scoreboard" value="Score" position="3 1 -3" color="black"></a-text>
      <a-text position="-6 1 -5" color="black" value="Controls:Z/X to move L/R\nEnter/Shift to Rotate cw/ccw.  Space to drop.  Refresh to restart."></a-text>

      <a-text id="log-1" value="Target Data" position="3 3 -5" color="black"></a-text>
      <a-text id="log-panel2" value="Proxy Controller Data" position="-1 3 -5" color="black"></a-text>
      <a-text id="log-panel3" value="Keyboard Sim Data" position="-5 3 -5" color="black"></a-text>

      <a-sky color="#ECECEC"></a-sky>
    </a-scene>
  </body>
</html>
